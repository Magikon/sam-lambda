const rollbar = require("./rollbar.js");
let source_detail_not_found = `{"error":{"code":500,"message":{"name":"MapError","stack":"MapError: PROPAIR-BANK Source Detail for Source Not Found! – Source: ANAMOLYSQUARED, Source Detail: LENDGOSSSSSSSSSSSSSS.\\n    at getExtraFields (/var/task/map.js:293:11)\\n    at propairMap (/var/task/map.js:205:43)\\n    at Runtime.exports.handler (/var/task/map.js:448:17)\\n    at Runtime.handleOnce (/var/runtime/Runtime.js:66:25)","message":"PROPAIR-BANK Source Detail for Source Not Found! – Source: ANAMOLYSQUARED, Source Detail: LENDGOSSSSSSSSSSSSSS.","mappingErrorType":"Source_Detail_for_Source_Not_Found"},"lead":{"id":"1101010","actionCount":"0","dateAdded":"2019-06-09 19:36:33","dayPhone":"617-434-6196","email":"Conrad85@gmail.com","eveningPhone":"821-110-5789","existingHomeValue":"1","firstName":"Robin","lastName":"Bosco","loanAmount":"$210957.53","propertyAddress":"05470 Labadie Forks Christy Station Valley","propertyState":"MS","propertyZipCode":"15679-8034","purchasePrice":"$591048.9500000001","IsMilitary":"Yes","CIS":"1.0","FICO":754,"campaign":"LENDGOssssssssssssss","campaignGroup":"RETIRED","creditProfile":"LOWERMYBILLS","intendedPropertyUse":"SECONDVACATIONHOME","lastDuplicate":"","loanPurpose":"HOMEEQUITYLOAN","propertyType":"SINGLEFAM","LeadProviderName":"ANAMOLYSQUARED","sre_timestamps":{"isColdStart":true}},"name":"PROPAIR-BANK Source Detail for Source Not Found! – Source: ANAMOLYSQUARED, Source Detail: LENDGOSSSSSSSSSSSSSS."},"referer":"Create","account":"propair-bank","account_id":10}`
let campaing_group_not_found = `{"error":{"code":500,"message":{"name":"MapError","stack":"MapError: CARDINAL-Campaign Group for Source Detail and Source Not Found! – Source: bankrate, Source Detail: RT, Campaign Group: WOWOWOWOWO.\\n    at getExtraFields (/var/task/map.js:371:13)\\n    at propairMap (/var/task/map.js:224:43)\\n    at Runtime.exports.handler (/var/task/map.js:538:17)\\n    at Runtime.handleOnce (/var/runtime/Runtime.js:66:25)","message":"CARDINAL-Campaign Group for Source Detail and Source Not Found! – Source: bankrate, Source Detail: RT, Campaign Group: WOWOWOWOWO.","mappingErrorType":"Campaign_Group_for_Source_Detail_and_Source_Not_Found"},"lead":{"id":"1390010","actionCount":"0","bankruptcyInLastSevenYears":"","campaign":"CD_Bankrate_RT","campaignGroup":"WOWOWOWOWO","cashOutAmount":"","creditProfile":"Excellent","dateAdded":"06/02/2020 15:38:31","dayPhone":"U2FsdGVkX18rwLKjxf3+yR0/RYvnIqi7u2S+phKoK4o=","downPaymentAmount":"","email":"U2FsdGVkX19CyO94mEFiWylxzrTgbAfqcq6/A/FLZCoXvDwHuln2jvaciKKPCOKx","eveningPhone":"U2FsdGVkX19GICCwNv6V2XVM3WGy2PgDChwRv26fwAI=","existingHomeValue":"270000","firstName":"U2FsdGVkX1+di1lcnd+ZYs1iTaypvLZAytXEHEDOtI0=","intendedPropertyUse":"","lastName":"U2FsdGVkX19j3SPAkHVmS30nmhYf6bkvQPS+COt6NSM=","leadSource":"","lastDuplicate":"","loanAmount":"230000","loanPurpose":"Refinance","propertyAddress":"U2FsdGVkX1+T2JEEoKVPPOUCqgstdDlgI6USfn8+CB0=","propertyState":"NC","propertyType":"Single Family Home","propertyZipCode":"27705","purchasePrice":"270000","IsMilitary":"","FICO":"740","incontact":"True"}},"referer":"Create","account":"cardinal","account_id":8}`
let source_not_found = `{"error":{"code":500,"message":"PROPAIR-BANK Source Not Found! – Source: anamolysquaredsssssssssssssssssssssssssssss.","stack":"MapError: PROPAIR-BANK Source Not Found! – Source: anamolysquaredsssssssssssssssssssssssssssss.\\n    at getExtraFields (/home/luis/Propair/propair-serverless/functions/leads/map/map.js:248:11)\\n    at propairMap (/home/luis/Propair/propair-serverless/functions/leads/map/map.js:202:43)\\n    at Object.exports.handler (/home/luis/Propair/propair-serverless/functions/leads/map/map.js:446:17)","map_error_type":"Source_Not_Found","lead":{"id":"411010101010","actionCount":"0","dateAdded":"2019-06-09 19:36:33","dayPhone":"617-434-6196","email":"Conrad85@gmail.com","eveningPhone":"821-110-5789","existingHomeValue":"1","firstName":"Robin","lastName":"Bosco","loanAmount":"$210957.53","propertyAddress":"05470 Labadie Forks Christy Station Valley","propertyState":"MS","propertyZipCode":"15679-8034","purchasePrice":"$591048.9500000001","IsMilitary":"Yes","CIS":"1.0","FICO":754,"campaign":"LENDGO","campaignGroup":"RETIRED","creditProfile":"LOWERMYBILLS","intendedPropertyUse":"SECONDVACATIONHOME","lastDuplicate":"","loanPurpose":"HOMEEQUITYLOAN","propertyType":"SINGLEFAM","LeadProviderName":"ANAMOLYSQUAREDsssssssssssssssssssssssssssss","sre_timestamps":{"isColdStart":true}}},"referer":"Create","account":"propair-bank","account_id":10}`
let message_recommend_error = `{"account": "propair-bank", "referer": "Recommend", "error": {"message": "PythonException", "type": "error", "name": "\'BIN_domain\'", "trace": {"exc_info": "\\"(<type \'exceptions.KeyError\'>, KeyError(\'BIN_domain\',), <traceback object at 0x7f15725d8280>)\\"", "event": {"customer": "propair-bank", "map": {"va": 0, "hmda_state_id": 34, "source_detail": "Website", "credit_score_stated": "738", "action_count": "0", "cis_score": "0.3", "property_use_stated": "PRIMARYHOME", "historical_from201701": null, "competition": 3, "BIN_source": "TWILIO", "credit_profile_stated": "518", "ialgo": 1, "loan_amount_stated": "729620.00", "account_lead_id": "1303737", "source": "TWILIO", "region_set1_name": "Northeast", "source_channel": "data", "coldstart": false, "purpose_detail_stated": "ARM", "BIN_property_type_stated": "Multi", "BIN_purpose_detail_stated": "None", "va_eligible_stated": "No", "region_set1": 1, "source_type": "form", "BIN_property_use_stated": "PrimaryHome", "historical_thru201612": null, "region_set2": 2, "BIN_credit_profile_stated": "Poor", "region_set2_name": "Tristate", "self_generated": 0, "mobile": 0, "property_state_stated": "NJ", "longform": 0, "property_type_stated": "MULTIFAMILYDWELLING", "home_value_stated": "1", "cob": 2737, "purchase_price_stated": "316625.00", "transfer": 0, "campaign_group": "Nine Hills Transfers", "lead_datetime": "3/17/2020 11:16 AM"}, "account_config": {"source_required": true, "CR_bins": [0.65, 0.55, 0.51, 0.45, 0.4, 0.3], "run_dynamic_rank": true, "repost_hours_from_now": 24, "repost_failure_threshold": 0.2, "fake_calls_config": {"incontact": {"campaign_names": ["CCD_Inbound_ThirdPartyXfer", "Admin", "CCD_NewLead", "CCD_Outbound", "CCD_Transfer", "CCD_Spanish", "SCD_Transfer", "SCD_Outbound", "Retention"], "days_ago": ["14", "28"], "disp_names": ["Abandon", "Answering Machine", "Bad Phone Number", "Call -  No Contact", "Call - Left Message", "Called Party Hang Up", "Inbound Call Disconnected", "Do Not Call", "Contacted Callback", "No Answer", "Not Interested", "Set Appointment", "Working With Other Lender"], "agents": [{"agent_id": 11403, "name": "Devon Johnson"}, {"agent_id": 11402, "name": "Rocks ProPair"}, {"agent_id": 11402, "name": "Recommendations GottaHaveThose"}, {"agent_id": 1, "name": "Ethan Ewing"}], "systems": [{"code": 24, "name": "Abandon"}, {"code": 86, "name": "Agent Override Answering Machine - No Message"}, {"code": 19, "name": "Answering Machine"}, {"code": 15, "name": "Busy"}, {"code": 32, "name": "Called Party Hang Up"}, {"code": 55, "name": "ISDN Cause Code 18"}, {"code": 23, "name": "Network Busy"}, {"code": 20, "name": "No Answer"}, {"code": 36, "name": "No Disposition"}, {"code": 6, "name": "Other"}, {"code": 82, "name": "Proactive Identified - Answering Machine"}, {"code": 10, "name": "Retry - Not Available"}], "skill_names": ["IN_SCD_NewLead", "IN_CCD_LocalPresence", "AZ_CCD_NewLead", "AK_CCD_LocalPresence", "AL_CCD_CallAttempts_C14C30", "CA_CCD_CallAttempts_C14C30", "FL_CCD_CallAttempts_C4C7", "GA_CCD_NewLead", "IL_CCD_CallAttempts_C4C7", "MN_CCD_CallAttempts_C14C30", "NV_CCD_CallAttempts_C14C30", "MO_CCD_NewLead", "NJ_CCD_CallAttempts_C8C14", "OR_CCD_CallAttempts_C4C7", "PA_CCD_NewLead_ON", "TN_CCD_NewLead", "TX_CCD_CallAttempts_C4C7", "TX_CCD_NewLead_ON", "UT_CCD_CallAttempts_C8C14", "WA_CCD_NewLead"]}, "velocify": {"min_ago": "30", "call_segment": ["Transfer", "Initial"], "days_ago": ["25"], "agents": [{"agent_id": 11403, "name": "Devon Johnson"}, {"agent_id": 11402, "name": "Rocks ProPair"}, {"agent_id": 11402, "name": "Recommendations GottaHaveThose"}, {"agent_id": 1, "name": "Ethan Ewing"}], "result": ["Abandoned", "Conversation", "No Answer", "Transfer", "Unkown", "Voicemail"], "call_origin": ["Inbound", "Outbound - Manual", "Outbound - Scheduled", "Outbound - Shotgun", "Record Voicemail", "Transfer", "Unknown"]}}, "run_rec_expansion": true, "id": 10, "repost": true, "RANDOMIZE_AGENT_ORDER": true, "source_detail_required": true, "calls_software": "incontact", "bad_data": {"int": ["4555666655888888887888999836", "1203940323", "Down", "0x271D", "0xF0", "0xE6", "U+0003", "e+213", "-", "+", ".", "#", "$$", "*", "l", "|", "@", "1", "2", "%", "13131312252525252", "11110010010000011110", "A", "\'"], "str": ["$$$", "x00f3", "0x1E60", "U+00C8", "U+02BA", "U+0217", "0x1E45", "0x1E53", "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.", "//", "\'"]}, "data_incremental_update_leads": true, "CUSTOM_RANK_THRESHOLD_REFI": 0.14, "pii_fields": ["firstname", "firstnamestated", "lastname", "lastnamestated", "email", "dayphone", "eveningphone", "emailstated", "velocify_password", "velocify_username"], "rec_weekend_start_time": "Friday 5:00 PM", "accepted_split_fields": ["purchase_price_stated", "home_value_stated", "loan_amount_stated", "down_payment"], "AB_ALGO1_SUFFIX": ":000402a", "rec_weekend_end_time": "Sunday 8:00 PM", "AB_ALGO2_SUFFIX": ":000402a", "rookie_rollout_months_timeframe": 0, "data_incremental_update_calls": true, "custom_rank": [{"prod_version_custom_rank": ":000101a", "CR_bins": {"REFI": [0.65, 0.55, 0.51, 0.45, 0.4, 0.3], "PUR": [0.65, 0.55, 0.51, 0.45, 0.4, 0.3]}, "run_custom_rank": true, "split_field_custom_rank": ["source"]}], "generate_leads_size": 2, "AB_RECOMMENDATION_THRESHOLD": 0.25, "domain_tld_list": ["BADDOMAIN", "COM", "EDU ", "GOV", "HARDBOUNCE", "NET", "OPTOUT", "ORG", "OTHER", "US"], "expand_rec_by_percentage": 80, "RECOMMENDATION_THRESHOLD": 0.5, "RECOMMENDATION_THRESHOLD_BRANCH": 0.7, "expand_rec_after_seconds": 1209600, "DR_bins": {"DR_28": [0.65, 0.55, 0.51, 0.45, 0.4, 0.3], "DR_14": [0.65, 0.55, 0.51, 0.45, 0.4, 0.3]}, "write_to_velocify": true, "rookie_rollout": false, "los_email_match": true, "CUSTOM_RANK_THRESHOLD_PUR": 0.09, "name": "propair-bank", "AB_ALGO_COUNT": 2, "data_incremental_update_events": true, "domain_list": ["AOL", "ATT", "COMCAST", "COX", "GMAIL", "HOTMAIL", "MSN", "OPTOUT", "OTHER", "SBCGLOBAL", "YAHOO"], "call_data_fromNowMinutes": 30, "event_data_pull_backfill": false, "leads_incremental_min_from": 30, "event_data_fromNowMinutes": 1, "use_custom_rank": true, "extra_fields_to_write": [{"leadField": "custom_rank_bin", "accountField": "custom_rank_bin_id"}], "RECOMMENDATION_THRESHOLD_WEEKEND": 0.7, "repost_sample_size": 30}, "agents": {"1": {"recommend": 1, "leads_on": 1, "source_exclusions": null, "rec_type": "full", "branch_group_id": 0, "account_name": "propair-bank", "branch_group_name": "None", "name_velocify": "Ewing, Ethan", "account_start_date": "2020-01-31T11:38:21.000Z", "branch": null, "rookie": null, "seconds_since_last_page_view": 5, "channel": null, "profile_id": "44482", "account_id": 10, "page_view_time_block_size_in_seconds": 600, "agent_id": 1, "active": 1, "alt_rec_type": null, "name": "Ethan Ewing", "page_views_in_last_time_block": 5, "dialiq_status_id": 1}, "11404": {"recommend": 1, "leads_on": 1, "source_exclusions": null, "rec_type": "full", "branch_group_id": 0, "account_name": "propair-bank", "branch_group_name": "None", "name_velocify": "ProPair, Rocks", "account_start_date": "2020-01-31T23:00:21.000Z", "branch": null, "rookie": null, "seconds_since_last_page_view": 5, "channel": null, "profile_id": "44481", "account_id": 10, "page_view_time_block_size_in_seconds": 600, "agent_id": 11404, "active": 1, "alt_rec_type": null, "name": "Rocks ProPair", "page_views_in_last_time_block": 5, "dialiq_status_id": 1}, "11403": {"recommend": 1, "leads_on": 1, "source_exclusions": null, "rec_type": "full", "branch_group_id": 0, "account_name": "propair-bank", "branch_group_name": "None", "name_velocify": "Johnson, Devon", "account_start_date": "2020-01-31T23:06:21.000Z", "branch": null, "rookie": null, "seconds_since_last_page_view": 5, "channel": null, "profile_id": "44484", "account_id": 10, "page_view_time_block_size_in_seconds": 600, "agent_id": 11403, "active": 1, "alt_rec_type": null, "name": "Devon Johnson", "page_views_in_last_time_block": 5, "dialiq_status_id": 1}, "11402": {"recommend": 1, "leads_on": 1, "source_exclusions": null, "rec_type": "full", "branch_group_id": 0, "account_name": "propair-bank", "branch_group_name": "None", "name_velocify": "GottaHaveThose, Recommendations", "account_start_date": "2019-08-15T03:00:24.000Z", "branch": null, "rookie": null, "seconds_since_last_page_view": 5, "channel": null, "profile_id": "44483", "account_id": 10, "page_view_time_block_size_in_seconds": 600, "agent_id": 11402, "active": 1, "alt_rec_type": null, "name": "Recommendations GottaHaveThose", "page_views_in_last_time_block": 5, "dialiq_status_id": 1}}, "probabilities": null}, "stack": "\\"Traceback (most recent call last):\\n  File \'/home/luis/Propair/propair-serverless/functions/leads/recommend/recommend.py\', line 1102, in recommend\\n    if (pd.isnull(lead_df.ix[0][ohe]) == False):\\n  File \'/home/luis/Propair/propair-serverless/functions/leads/recommend/pandas/core/series.py\', line 766, in __getitem__\\n    result = self.index.get_value(self, key)\\n  File \'/home/luis/Propair/propair-serverless/functions/leads/recommend/pandas/core/indexes/base.py\', line 3117, in get_value\\n    raise e1\\nKeyError: \'BIN_domain\'\\n\\""}}}`
let source_detail_missing = `{"error":{"code":500,"message":"PROPAIR-BANK Source Detail Missing!","stack":"MapError: PROPAIR-BANK Source Detail Missing!\\n    at getExtraFields (/home/luis/Propair/propair-serverless/functions/leads/map/map.js:236:13)\\n    at propairMap (/home/luis/Propair/propair-serverless/functions/leads/map/map.js:202:43)\\n    at Object.exports.handler (/home/luis/Propair/propair-serverless/functions/leads/map/map.js:445:17)","map_error_type":"Source_Detail_Missing","lead":{"id":"411010101010","actionCount":"0","dateAdded":"2019-06-09 19:36:33","dayPhone":"617-434-6196","email":"Conrad85@gmail.com","eveningPhone":"821-110-5789","existingHomeValue":"1","firstName":"Robin","lastName":"Bosco","loanAmount":"$210957.53","propertyAddress":"05470 Labadie Forks Christy Station Valley","propertyState":"MS","propertyZipCode":"15679-8034","purchasePrice":"$591048.9500000001","IsMilitary":"Yes","CIS":"1.0","FICO":754,"campaignGroup":"RETIRED","creditProfile":"LOWERMYBILLS","intendedPropertyUse":"SECONDVACATIONHOME","lastDuplicate":"","loanPurpose":"HOMEEQUITYLOAN","propertyType":"SINGLEFAM","LeadProviderName":"ANAMOLYSQUARED","sre_timestamps":{"isColdStart":true}}},"referer":"Create","account":"propair-bank","account_id":10}`
let db_error = `{"error":{"name":"database dadadada does not exist","length":138,"severity":"FATAL","code":"3D000","file":"/home/ec2-user/padb/src/pg/src/backend/utils/init/postinit.c","line":"386","routine":"LcInitPostgres"},"referer":"Create","account":null,"account_id":null,"stack":"error: database dadadada does not exist\n    at Connection.parseE (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/node-redshift/node_modules/pg/lib/connection.js:567:11)\n    at Connection.parseMessage (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/node-redshift/node_modules/pg/lib/connection.js:391:17)\n    at Socket.<anonymous> (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/node-redshift/node_modules/pg/lib/connection.js:129:22)\n    at Socket.emit (events.js:198:13)\n    at Socket.EventEmitter.emit (domain.js:448:20)\n    at addChunk (_stream_readable.js:288:12)\n    at readableAddChunk (_stream_readable.js:269:11)\n    at Socket.Readable.push (_stream_readable.js:224:10)\n    at TCP.onStreamRead [as onread] (internal/stream_base_commons.js:94:17)"}`
let auth_error = `{"stack":"UnauthorizedError: Authorization token invalid\n    at Promise (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:95:33)\n    at process._tickCallback (internal/process/next_tick.js:68:7)","message":"Authorization token invalid","name":"UnauthorizedError","referer":"UnauthorizedError","lead":{"id":"1426413"}}`
let recommend_error = `{"account": "propair-bank", "referer": "Recommend", "error": {"message": "PythonException", "type": "error", "name": "Encoding Failure: Error . sum(region_set1_name) = 0", "trace": {"exc_info": "\\"(<type \'exceptions.ValueError\'>, ValueError(\'Encoding Failure: Error . sum(region_set1_name) = 0\',), <traceback object at 0x7f7b7c028eb0>)\\"", "event": {"customer": "propair-bank", "map": {"BIN_domain_MSN": 0.0, "lead_date_day_Thursday": 0.0, "BIN_purpose_detail_stated": "Refi", "hmda_state_id": 15, "BIN_purpose_detail_stated_Reverse": 0.0, "lead_date_hour": "A05", "source_channel_data": 1.0, "lead_date_hour_A08": 0.0, "lead_date_hour_A09": 0.0, "lead_date_hour_A00": 0.0, "lead_date_hour_A01": 0.0, "lead_date_hour_A02": 0.0, "lead_date_hour_A03": 0.0, "lead_date_hour_A04": 0.0, "lead_date_hour_A05": 1.0, "lead_date_hour_A06": 0.0, "lead_date_hour_A07": 0.0, "source": "HAWKEYEMARKETING", "region_set1_name_Mountain": 0.0, "BIN_domain_HOTMAIL": 1.0, "region_set1": 6, "BIN_property_use_stated": "PrimaryHome", "lead_date_day_Tuesday": 0.0, "BIN_domain_tld": "OTHER", "source_type_offline": 0.0, "self_generated": 1, "BIN_property_use_stated_Investment": 0.0, "lead_date_hour_A19": 0.0, "lead_date_hour_A18": 0.0, "lead_date_hour_A17": 0.0, "lead_date_hour_A16": 0.0, "lead_date_hour_A15": 0.0, "lead_date_hour_A14": 0.0, "lead_date_hour_A13": 0.0, "lead_date_hour_A12": 0.0, "lead_date_hour_A11": 0.0, "lead_date_hour_A10": 0.0, "region_set1_name_Midwest": 0.0, "BIN_property_type_stated_SFR": 1.0, "domain": "hotmail", "lead_date_day_Friday": 0.0, "competition": "exclusive", "source_type_portfolio": 1.0, "home_value_corr": 1, "lead_date": 1582675200000, "historical_from201701": "None", "ialgo": 0, "BIN_property_use_stated_SecondHome": 0.0, "BIN_domain": "HOTMAIL", "BIN_source": "HAWKEYE", "region_set1_name": "Westsssss", "region_set1_name_Southeast": 0.0, "purpose_detail_stated": "DEBTCONSOLIDATION", "loan_amount_stated": 686148, "BIN_property_use_stated_PrimaryHome": 1.0, "BIN_domain_OTHER": 0.0, "lead_date_day_Saturday": 0.0, "domain_tld": "com", "BIN_domain_SBCGLOBAL": 0.0, "historical_thru201612": "None", "loan_amount_corr": 0.686148, "region_set2_name": "West", "region_set1_name_West": 1.0, "BIN_property_type_stated_Condo": 0.0, "credit_profile_stated": "631", "source_type_test": 0.0, "BIN_domain_tld_COM": 1.0, "BIN_domain_COMCAST": 0.0, "BIN_credit_profile_stated_Good": 0.0, "lead_datetime": 1582695960000, "credit_score_stated": "528", "region_set2": 9, "cis_score": "0.6", "property_use_stated": "OCCUPY", "BIN_property_type_stated_TownH": 0.0, "BIN_credit_profile_stated_Fair": 0.0, "BIN_purpose_detail_stated_Refi": 1.0, "transfer": 0, "BIN_domain_OPTOUT": 0.0, "BIN_domain_AOL": 0.0, "lead_date_day_Sunday": 0.0, "BC_ltv_calc": 0.1583365473, "source_channel": "data", "BIN_property_type_stated": "SFR", "ltv_calc": 0.8, "va_eligible_stated": "no", "BIN_credit_profile_stated_Poor": 1.0, "BIN_credit_profile_stated_Excellent": 0.0, "BIN_purpose_detail_stated_Purchase": 0.0, "action_count": "0", "BIN_credit_profile_stated": "Poor", "property_state_stated": "HI", "BC_loan_amount_corr": 2.3649276942, "longform": 0, "property_type_stated": "UNKNOWN", "lead_date_day": "Wednesday", "source_type_form": 0.0, "va": 0, "source_detail": "Lendilio", "BIN_property_type_stated_Multi": 0.0, "cv_group": "000402a", "BIN_purpose_detail_stated_Construction": 0.0, "lead_date_day_Monday": 0.0, "lead_date_hour_A22": 0.0, "lead_date_hour_A23": 0.0, "lead_date_hour_A20": 0.0, "lead_date_hour_A21": 0.0, "lead_date_day_Wednesday": 1.0, "account_lead_id": "1274777", "cob": 4158, "BIN_domain_ATT": 0.0, "region_set1_name_Northeast": 0.0, "BIN_domain_YAHOO": 0.0, "region_set1_name_Southwest": 0.0, "source_type": "portfolio", "source_channel_phone": 0.0, "BIN_domain_COX": 0.0, "credit_corr": 528, "BIN_property_type_stated_MFH": 0.0, "mobile": 0, "BIN_domain_GMAIL": 0.0, "BIN_purpose_detail_stated_HELOC": 0.0, "home_value_stated": 1, "purchase_price_stated": 621602.003, "campaign_group": "SE 3rd Party"}, "account_config": {"source_required": true, "CR_bins": [0.65, 0.55, 0.51, 0.45, 0.4, 0.3], "run_dynamic_rank": true, "bad_data": {"int": ["4555666655888888887888999836", "1203940323", "Down", "0x271D", "0xF0", "0xE6", "U+0003", "e+213", "-", "+", ".", "#", "$$", "*", "l", "|", "@", "1", "2", "%", "13131312252525252", "11110010010000011110", "A", "\'"], "str": ["$$$", "x00f3", "0x1E60", "U+00C8", "U+02BA", "U+0217", "0x1E45", "0x1E53", "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.", "//", "\'"]}, "repost_failure_threshold": 0.2, "fake_calls_config": {"incontact": {"campaign_names": ["CCD_Inbound_ThirdPartyXfer", "Admin", "CCD_NewLead", "CCD_Outbound", "CCD_Transfer", "CCD_Spanish", "SCD_Transfer", "SCD_Outbound", "Retention"], "days_ago": ["14", "28"], "disp_names": ["Abandon", "Answering Machine", "Bad Phone Number", "Call -  No Contact", "Call - Left Message", "Called Party Hang Up", "Inbound Call Disconnected", "Do Not Call", "Contacted Callback", "No Answer", "Not Interested", "Set Appointment", "Working With Other Lender"], "agents": [{"agent_id": 11403, "name": "Devon Johnson"}, {"agent_id": 11402, "name": "Rocks ProPair"}, {"agent_id": 11402, "name": "Recommendations GottaHaveThose"}, {"agent_id": 1, "name": "Ethan Ewing"}], "systems": [{"code": 24, "name": "Abandon"}, {"code": 86, "name": "Agent Override Answering Machine - No Message"}, {"code": 19, "name": "Answering Machine"}, {"code": 15, "name": "Busy"}, {"code": 32, "name": "Called Party Hang Up"}, {"code": 55, "name": "ISDN Cause Code 18"}, {"code": 23, "name": "Network Busy"}, {"code": 20, "name": "No Answer"}, {"code": 36, "name": "No Disposition"}, {"code": 6, "name": "Other"}, {"code": 82, "name": "Proactive Identified - Answering Machine"}, {"code": 10, "name": "Retry - Not Available"}], "skill_names": ["IN_SCD_NewLead", "IN_CCD_LocalPresence", "AZ_CCD_NewLead", "AK_CCD_LocalPresence", "AL_CCD_CallAttempts_C14C30", "CA_CCD_CallAttempts_C14C30", "FL_CCD_CallAttempts_C4C7", "GA_CCD_NewLead", "IL_CCD_CallAttempts_C4C7", "MN_CCD_CallAttempts_C14C30", "NV_CCD_CallAttempts_C14C30", "MO_CCD_NewLead", "NJ_CCD_CallAttempts_C8C14", "OR_CCD_CallAttempts_C4C7", "PA_CCD_NewLead_ON", "TN_CCD_NewLead", "TX_CCD_CallAttempts_C4C7", "TX_CCD_NewLead_ON", "UT_CCD_CallAttempts_C8C14", "WA_CCD_NewLead"]}, "velocify": {"min_ago": "30", "call_segment": ["Transfer", "Initial"], "days_ago": ["25"], "agents": [{"agent_id": 11403, "name": "Devon Johnson"}, {"agent_id": 11402, "name": "Rocks ProPair"}, {"agent_id": 11402, "name": "Recommendations GottaHaveThose"}, {"agent_id": 1, "name": "Ethan Ewing"}], "result": ["Abandoned", "Conversation", "No Answer", "Transfer", "Unkown", "Voicemail"], "call_origin": ["Inbound", "Outbound - Manual", "Outbound - Scheduled", "Outbound - Shotgun", "Record Voicemail", "Transfer", "Unknown"]}}, "run_rec_expansion": true, "id": 10, "repost": true, "RANDOMIZE_AGENT_ORDER": true, "source_detail_required": true, "calls_software": "incontact", "data_incremental_update_leads": true, "CUSTOM_RANK_THRESHOLD_REFI": 0.14, "pii_fields": ["firstname", "firstnamestated", "lastname", "lastnamestated", "email", "dayphone", "eveningphone", "emailstated", "velocify_password", "velocify_username"], "rec_weekend_start_time": "Friday 5:00 PM", "accepted_split_fields": ["purchase_price_stated", "home_value_stated", "loan_amount_stated", "down_payment"], "AB_ALGO1_SUFFIX": ":000402a", "repost_hours_from_now": 24, "rec_weekend_end_time": "Sunday 8:00 PM", "event_data_fromNowMinutes": 1, "rookie_rollout_months_timeframe": 0, "data_incremental_update_calls": true, "generate_leads_size": 2, "AB_RECOMMENDATION_THRESHOLD": 0.25, "expand_rec_by_percentage": 80, "RECOMMENDATION_THRESHOLD": 0.5, "RECOMMENDATION_THRESHOLD_BRANCH": 0.7, "expand_rec_after_seconds": 1209600, "DR_bins": {"DR_28": [0.65, 0.55, 0.51, 0.45, 0.4, 0.3], "DR_14": [0.65, 0.55, 0.51, 0.45, 0.4, 0.3]}, "write_to_velocify": true, "rookie_rollout": false, "extra_fields_to_write": [{"leadField": "custom_rank_bin", "accountField": "custom_rank_bin_id"}], "RECOMMENDATION_THRESHOLD_WEEKEND": 0.7, "name": "propair-bank", "AB_ALGO_COUNT": 2, "data_incremental_update_events": true, "domain_list": ["AOL", "ATT", "COMCAST", "COX", "GMAIL", "HOTMAIL", "MSN", "OPTOUT", "OTHER", "SBCGLOBAL", "YAHOO"], "call_data_fromNowMinutes": 30, "event_data_pull_backfill": false, "leads_incremental_min_from": 30, "AB_ALGO2_SUFFIX": ":000402a", "use_custom_rank": true, "domain_tld_list": ["BADDOMAIN", "COM", "EDU ", "GOV", "HARDBOUNCE", "NET", "OPTOUT", "ORG", "OTHER", "US"], "CUSTOM_RANK_THRESHOLD_PUR": 0.09, "repost_sample_size": 30}, "agents": {"1": {"recommend": 1, "profile_id": "44482", "source_exclusions": null, "rec_type": "full", "leads_on": 1, "account_name": "propair-bank", "branch_group_name": "None", "name_velocify": "Ewing, Ethan", "account_start_date": "2020-01-31T11:38:21.000Z", "branch": null, "rookie": null, "seconds_since_last_page_view": 5, "channel": null, "branch_group_id": 0, "account_id": 10, "page_view_time_block_size_in_seconds": 600, "agent_id": 1, "active": 1, "alt_rec_type": null, "name": "Ethan Ewing", "page_views_in_last_time_block": 5, "dialiq_status_id": 1}, "11404": {"recommend": 1, "profile_id": "44481", "source_exclusions": null, "rec_type": "full", "leads_on": 1, "account_name": "propair-bank", "branch_group_name": "None", "name_velocify": "ProPair, Rocks", "account_start_date": "2020-01-31T23:00:21.000Z", "branch": null, "rookie": null, "seconds_since_last_page_view": 5, "channel": null, "branch_group_id": 0, "account_id": 10, "page_view_time_block_size_in_seconds": 600, "agent_id": 11404, "active": 1, 
"alt_rec_type": null, "name": "Rocks ProPair", "page_views_in_last_time_block": 5, "dialiq_status_id": 1}, "11403": {"recommend": 1, "profile_id": "44484", "source_exclusions": null, "rec_type": "full", "leads_on": 1, "account_name": "propair-bank", "branch_group_name": "None", "name_velocify": "Johnson, Devon", "account_start_date": "2020-01-31T23:06:21.000Z", "branch": null, "rookie": null, "seconds_since_last_page_view": 5, "channel": null, "branch_group_id": 0, "account_id": 10, "page_view_time_block_size_in_seconds": 600, "agent_id": 11403, "active": 1, "alt_rec_type": null, "name": "Devon Johnson", "page_views_in_last_time_block": 5, "dialiq_status_id": 1}, "11402": {"recommend": 1, "profile_id": "44483", "source_exclusions": null, "rec_type": "full", "leads_on": 1, "account_name": "propair-bank", "branch_group_name": "None", "name_velocify": "GottaHaveThose, Recommendations", "account_start_date": "2019-08-15T03:00:24.000Z", "branch": null, "rookie": null, "seconds_since_last_page_view": 5, "channel": null, "branch_group_id": 0, "account_id": 10, "page_view_time_block_size_in_seconds": 600, "agent_id": 11402, "active": 1, "alt_rec_type": null, "name": "Recommendations GottaHaveThose", "page_views_in_last_time_block": 5, "dialiq_status_id": 1}}}, "stack": "\\"Traceback (most recent call last):\\n  File \'/home/luis/Propair/propair-serverless/functions/leads/recommend/recommend.py\', line 1456, in recommend\\n    .format(core_feature,int(sum(lead_df.ix[0][tmp_list]))))\\nValueError: Encoding Failure: Error . sum(region_set1_name) = 0\\n\\""}}}`
let mapping_failure = `{"error":{"code":500,"message":{"name":"MapError","lead":{"id":"411010101010","actionCount":"0","dateAdded":"2019-06-09 19:36:33","dayPhone":"617-434-6196","email":"Conrad85@gmail.com","eveningPhone":"821-110-5789","existingHomeValue":"1","firstName":"Robin","lastName":"Bosco","loanAmount":"$210957.53","propertyAddress":"05470 Labadie Forks Christy Station Valley","propertyState":"MS","propertyZipCode":"15679-8034","purchasePrice":"$591048.9500000001","IsMilitary":"Yes","CIS":"1.0","FICO":754,"campaign":"LENDGO","campaignGroup":"RETIRED","creditProfile":"LOWERMYBILLS","intendedPropertyUse":"SECONDVACATIONHOME","lastDuplicate":"","loanPurpose":"HOMEEQUITYLOAN","propertyType":"SINGLEFAM","LeadProviderName":"ANAMOLYSQUARED","sre_timestamps":{"isColdStart":true}},"customer":"propair-bank","mappingErrorType":"Mapping_Failure"},"lead":{"id":"411010101010","actionCount":"0","dateAdded":"2019-06-09 19:36:33","dayPhone":"617-434-6196","email":"Conrad85@gmail.com","eveningPhone":"821-110-5789","existingHomeValue":"1","firstName":"Robin","lastName":"Bosco","loanAmount":"$210957.53","propertyAddress":"05470 Labadie Forks Christy Station Valley","propertyState":"MS","propertyZipCode":"15679-8034","purchasePrice":"$591048.9500000001","IsMilitary":"Yes","CIS":"1.0","FICO":754,"campaign":"LENDGO","campaignGroup":"RETIRED","creditProfile":"LOWERMYBILLS","intendedPropertyUse":"SECONDVACATIONHOME","lastDuplicate":"","loanPurpose":"HOMEEQUITYLOAN","propertyType":"SINGLEFAM","LeadProviderName":"ANAMOLYSQUARED","sre_timestamps":{"isColdStart":true}}},"referer":"Create","account":"propair-bank","account_id":10}`
let velocify_error = `{"stack":"ModifyLeadError: Field does not exist\n    at fields.forEach.f (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:258:31)\n    at Array.forEach (<anonymous>)\n    at Promise (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:253:12)\n    at new Promise (<anonymous>)\n    at modifyLead (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:251:10)\n    at Promise (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:391:9)\n    at new Promise (<anonymous>)\n    at velocify (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:350:10)\n    at Object.exports.handler (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:763:15)\n    at process._tickCallback (internal/process/next_tick.js:68:7)","message":"Field does not exist","name":"ModifyLeadError","referer":"ModifyLeadError","field":"velocify_rec_field_1_id","lead":{"id":"1426413","creditScore":"","actionCount":"0","campaign":"Perks","campaignGroup":"Perks","creditProfile":"490","dateAdded":"6/15/2020 9:46 AM","dayPhone":"11111111","email":"aa@company.com","eveningPhone":"222222222","existingHomeValue":"1","firstName":"Geralt","intendedPropertyUse":"SECONDHOME","lastDuplicate":"","lastName":"Rivia","loanAmount":"617931.00","loanPurpose":"UNKNOWN","propertyAddress":"35th Sreet","propertyState":"WESTVIRGINIA","propertyType":"MULTIFAMILYHOME","propertyZipCode":"57877","purchasePrice":"702718.00","LeadProviderName":"CALLCENTER","leadProviderName":"CALLCENTER","IsMilitary":"Yes","CIS":"0.7","FICO":"811","CustomerId":"","FilterID":"","downPayment":"","downPaymentAmount":"","bankruptcyInLastSevenYears":"","propair_id":null,"probabilities":"","features":"","reassignment":0,"custom_rank":null,"custom_rank_bin":0,"availableAgents":null,"availableAgentsThreshold":null,"agentsAdded":null,"agentOrderRecommendation":null,"agentOrderProbabilities":"","trimmedRecommendation":":CRn:0000y","recommendation":":1y:11402y:11403y:11404y:CRn:0000y","originalRecommendation":null},"account":"propair-bank","account_id":10}`

let modify_lead_error = `{"stack":"ModifyLeadError: Lead Result Field not found!.\n    at fields.forEach.f (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:272:31)\n    at Array.forEach (<anonymous>)\n    at Promise (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:253:12)\n    at new Promise (<anonymous>)\n    at modifyLead (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:251:10)\n    at Promise (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:393:9)\n    at new Promise (<anonymous>)\n    at velocify (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:352:10)\n    at Object.exports.handler (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:765:15)\n    at process._tickCallback (internal/process/next_tick.js:68:7)","message":"Lead Result Field not found!.","name":"ModifyLeadError","referer":"ModifyLeadError","field":"trimmedRecommendation","lead":{"id":"1426413","creditScore":"","actionCount":"0","campaign":"Perks","campaignGroup":"Perks","creditProfile":"490","dateAdded":"6/15/2020 9:46 AM","dayPhone":"11111111","email":"aa@company.com","eveningPhone":"222222222","existingHomeValue":"1","firstName":"Geralt","intendedPropertyUse":"SECONDHOME","lastDuplicate":"","lastName":"Rivia","loanAmount":"617931.00","loanPurpose":"UNKNOWN","propertyAddress":"35th Sreet","propertyState":"WESTVIRGINIA","propertyType":"MULTIFAMILYHOME","propertyZipCode":"57877","purchasePrice":"702718.00","LeadProviderName":"CALLCENTER","leadProviderName":"CALLCENTER","IsMilitary":"Yes","CIS":"0.7","FICO":"811","CustomerId":"","FilterID":"","downPayment":"","downPaymentAmount":"","bankruptcyInLastSevenYears":"","propair_id":null,"probabilities":"","features":"","reassignment":0,"custom_rank":null,"availableAgents":null,"availableAgentsThreshold":null,"agentsAdded":null,"agentOrderRecommendation":null,"agentOrderProbabilities":"","recommendation":":1y:11402y:11403y:11404y:CRn:0000y","originalRecommendation":null},"account":"propair-bank","account_id":10}`

let conn_refused = `{"error":{"code":401,"message":{"stack":"ConnectionRefusedError: connect ETIMEDOUT 10.34.16.96:5439\n    at client.connect (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:38:42)\n    at Client.<anonymous> (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/node-redshift/node_modules/pg/lib/client.js:203:5)\n    at Connection.emit (events.js:198:13)\n    at Connection.EventEmitter.emit (domain.js:448:20)\n    at Socket.<anonymous> (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/node-redshift/node_modules/pg/lib/connection.js:86:10)\n    at Socket.emit (events.js:198:13)\n    at Socket.EventEmitter.emit (domain.js:448:20)\n    at emitErrorNT (internal/streams/destroy.js:91:8)\n    at emitErrorAndCloseNT (internal/streams/destroy.js:59:3)\n    at process._tickCallback (internal/process/next_tick.js:63:19)","message":"connect ETIMEDOUT 10.34.16.96:5439","name":"ConnectionRefusedError","extra":{}},"lead":{"id":"-1","actionCount":"0","campaign":"Lendilio","campaignGroup":"SE 3rd Party","creditProfile":"620679","dateAdded":"3/18/2020 1:46 PM","dayPhone":"888888","email":"U2FsdGVkX1+hX666UYujQf4VpPZig1N+C7kM8xLF5sl32+CPLvwMZk7ofGCy4ikcC9cuv0cZtk5aI00cBofa5w==","eveningPhone":"U2FsdGVkX19YAryySf6c0xYyx6m/3lwpBvHvayovzr8=","existingHomeValue":"1","firstName":"U2FsdGVkX1+43jq9Zxc+AfZr7kuq24J5vrDCusx/Tsw=","intendedPropertyUse":"SECONDARYVACTN","lastDuplicate":"","lastName":"U2FsdGVkX19moDjetD4Dc/d2DzgGGlyBB2jsc3yElWA=","loanAmount":"287903.00","loanPurpose":"HOMEPURCHASELOAN","propertyAddress":"na","propertyState":"6241","propertyType":"CONDOMINIUMTOWNHOME","propertyZipCode":"54044","purchasePrice":"621965.00","LeadProviderName":"BESTRATEREFERRALS","IsMilitary":"Yes","CIS":"0.1","FICO":"846","sre_timestamps":{"isColdStart":true}}},"referer":"Create","account":null,"account_id":null}`
let insertError = `{"stack":"InsertRecord: testing\n    at Object.exports.handler (/home/luis/Propair/propair-serverless/functions/leads/insert/insert.js:62:25)\n    at process._tickCallback (internal/process/next_tick.js:68:7)","message":"testing","name":"InsertRecord","referer":"InsertRecord"}`
let new_ver = `{"name":"MapError","stack":"MapError: CARDINAL-Campaign Group for Source Detail and Source Not Found! – Source: bankrate, Source Detail: RT, Campaign Group: WOWOWOWOWOWOW.\\n    at getExtraFields (/var/task/map.js:371:13)\\n    at propairMap (/var/task/map.js:224:43)\\n    at Runtime.exports.handler (/var/task/map.js:538:17)\\n    at Runtime.handleOnce (/var/runtime/Runtime.js:66:25)","message":"CARDINAL-Campaign Group for Source Detail and Source Not Found! – Source: bankrate, Source Detail: RT, Campaign Group: WOWOWOWOWOWOW.","mappingErrorType":"Campaign_Group_for_Source_Detail_and_Source_Not_Found","lead":{"id":"1390010","actionCount":"0","bankruptcyInLastSevenYears":"","campaign":"CD_Bankrate_RT","campaignGroup":"WOWOWOWOWOWOW","cashOutAmount":"","creditProfile":"Excellent","dateAdded":"06/02/2020 15:38:31","dayPhone":"89975555","downPaymentAmount":"","email":"gg@comapny.com","eveningPhone":"88888888","existingHomeValue":"270000","firstName":"Gerald","intendedPropertyUse":"","lastName":"Rivia","leadSource":"","lastDuplicate":"","loanAmount":"230000","loanPurpose":"Refinance","propertyAddress":"35th Street","propertyState":"NC","propertyType":"Single Family Home","propertyZipCode":"27705","purchasePrice":"270000","IsMilitary":"","FICO":"740","incontact":"True"},"referer":"Create"}`

let get_lead_error = `{"stack":"Misc: column payloadssssss does not exist in leads\n    at Promise (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:108:23)\n    at process._tickCallback (internal/process/next_tick.js:68:7)","message":"column payloadssssss does not exist in leads","name":"Misc","referer":"Misc","lead":{"id":"1390010","actionCount":"0","bankruptcyInLastSevenYears":"","campaign":"CD_Bankrate_RT","campaignGroup":"Sebonic 1 | Outbound","cashOutAmount":"","creditProfile":"Excellent","dateAdded":"06/02/2020 15:38:31","dayPhone":"89975555","downPaymentAmount":"","email":"gg@comapny.com","eveningPhone":"88888888","existingHomeValue":"270000","firstName":"Gerald","intendedPropertyUse":"","lastName":"Rivia","leadSource":"","lastDuplicate":"","loanAmount":"230000","loanPurpose":"Refinance","propertyAddress":"35th Street","propertyState":"NC","propertyType":"Single Family Home","propertyZipCode":"27705","purchasePrice":"270000","IsMilitary":"","FICO":"740","incontact":"True"},"account":"cardinal","account_id":8}`

let recommend_parsing = `{"stack":"ProPairParsingRecommendError: Dummy Error Test\n    at Response.<anonymous> (/home/luis/Propair/propair-serverless/functions/leads/create/create.js:229:38)\n    at Request.<anonymous> (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/request.js:364:18)\n    at Request.callListeners (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/sequential_executor.js:106:20)\n    at Request.emit (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/sequential_executor.js:78:10)\n    at Request.emit (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/request.js:683:14)\n    at Request.transition (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/request.js:22:10)\n    at AcceptorStateMachine.runTo (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/state_machine.js:14:12)\n    at /home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/state_machine.js:26:10\n    at Request.<anonymous> (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/request.js:38:9)\n    at Request.<anonymous> (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/request.js:685:12)\n    at Request.callListeners (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/sequential_executor.js:116:18)\n    at Request.emit (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/sequential_executor.js:78:10)\n    at Request.emit (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/request.js:683:14)\n    at Request.transition (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/request.js:22:10)\n    at AcceptorStateMachine.runTo (/home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/state_machine.js:14:12)\n    at /home/luis/Propair/propair-serverless/functions/leads/create/node_modules/aws-sdk/lib/state_machine.js:26:10","message":"Dummy Error Test","name":"ProPairParsingRecommendError","referer":"ProPairParsingRecommendError","lead":{"id":"1426413","creditScore":"","actionCount":"0","campaign":"Perks","campaignGroup":"Perks","creditProfile":"490","dateAdded":"6/15/2020 9:46 AM","dayPhone":"11111111","email":"aa@company.com","eveningPhone":"222222222","existingHomeValue":"1","firstName":"Geralt","intendedPropertyUse":"SECONDHOME","lastDuplicate":"","lastName":"Rivia","loanAmount":"617931.00","loanPurpose":"UNKNOWN","propertyAddress":"35th Sreet","propertyState":"WESTVIRGINIA","propertyType":"MULTIFAMILYHOME","propertyZipCode":"57877","purchasePrice":"702718.00","LeadProviderName":"CALLCENTER","leadProviderName":"CALLCENTER","IsMilitary":"Yes","CIS":"0.7","FICO":"811","CustomerId":"","FilterID":"","downPayment":"","downPaymentAmount":"","bankruptcyInLastSevenYears":"","propair_id":null,"probabilities":"","features":"","reassignment":0,"custom_rank":null,"custom_rank_bin":0,"availableAgents":null,"availableAgentsThreshold":null,"agentsAdded":null,"agentOrderRecommendation":null,"agentOrderProbabilities":"","trimmedRecommendation":null,"originalRecommendation":null},"account":"propair-bank","account_id":10}`

let recommend_new = `{"map": {"va": 0, "source_description": "CCD", "hmda_state_id": 47, "source_detail": "Fetcharate", "region_set1": 2, "competition": 3, "property_use_stated": "Primary Residence", "mobile": 0, "historical_from201701": null, "BIN_source": "ALL OTHER", "ialgo": 1, "source_division2": "Data Lead", "account_lead_id": null, "source": "Lendgo", "cob": 0, "BIN_credit_profile_stated": "Good", "region_set1_name": "Southeast", "source_channel": "data", "coldstart": false, "purpose_detail_stated": "Refinance", "BIN_property_type_stated": "SFR", "BIN_purpose_detail_stated": "Refi", "va_eligible_stated": false, "source_division": "CFD", "loan_amount_stated": 87500, "source_type": "form", "BIN_property_use_stated": "PrimaryHome", "historical_thru201612": null, "region_set2": 4, "propair_id": "165ac53a7d", "self_generated": 0, "credit_profile_stated": "Good", "property_state_stated": "TN", "longform": 0, "property_type_stated": "Single Family", "home_value_stated": 127500, "transfer": 0, "region_set2_name": "Southeast", "campaign_group": "CCD | Data Lead", "lead_datetime": "2020-05-21T03:48:22.773Z"}, "account": "cardinal", "name": "Recommend", "exec_info": "(<type \'exceptions.KeyError\'>, KeyError(\'lead_id\',), <traceback object at 0x7f62ee200690>)", "error_type": "PythonException", "referer": "Recommend", "message": "File ./license_summaries/cardinal_license_summary_lookup.csv does not exist", "stack": "Traceback (most recent call last):\\n  File /home/luis/Propair/propair-serverless/functions/leads/recommend/recommend.py, line 724, in recommend\\n    license_summary_df = pd.read_csv(\'./license_summaries/{}_license_summary_lookup.csv\'.format(ACCOUNT))\\n  File /home/luis/Propair/propair-serverless/functions/leads/recommend/pandas/io/parsers.py, line 678, in parser_f\\n    return _read(filepath_or_buffer, kwds)\\n  File /home/luis/Propair/propair-serverless/functions/leads/recommend/pandas/io/parsers.py, line 440, in _read\\n    parser = TextFileReader(filepath_or_buffer, **kwds)\\n  File /home/luis/Propair/propair-serverless/functions/leads/recommend/pandas/io/parsers.py, line 787, in __init__\\n    self._make_engine(self.engine)\\n  File /home/luis/Propair/propair-serverless/functions/leads/recommend/pandas/io/parsers.py, line 1014, in _make_engine\\n    self._engine = CParserWrapper(self.f, **self.options)\\n  File /home/luis/Propair/propair-serverless/functions/leads/recommend/pandas/io/parsers.py, line 1708, in __init__\\n    self._reader = parsers.TextReader(src, **kwds)\\n  File pandas/_libs/parsers.pyx, line 384, in pandas._libs.parsers.TextReader.__cinit__\\n  File pandas/_libs/parsers.pyx, line 695, in pandas._libs.parsers.TextReader._setup_parser_source\\nIOError: File ./license_summaries/cardinal_license_summary_lookup.csv does not exist\\n"}`

let source_missing = `{"name":"Create","stack":"MapError: PROPAIR-BANK Source Missing!\\n    at getExtraFields (/var/task/map.js:255:13)\\n    at propairMap (/var/task/map.js:231:43)\\n    at Runtime.exports.handler (/var/task/map.js:541:17)\\n    at Runtime.handleOnce (/var/runtime/Runtime.js:66:25)","message":"PROPAIR-BANK Source Missing!","mappingErrorType":"Source_Missing","lead":{"id":"1426413","creditScore":"","actionCount":"0","bankruptcyInLastSevenYears":"","campaignId":"1051","campaign":"CD_Zillow_RT","cashOutAmount":"","creditProfile":"Excellent","dateAdded":"06/02/2020 15:38:31","dayPhone":"U2FsdGVkX18rwLKjxf3+yR0/RYvnIqi7u2S+phKoK4o=","downPaymentAmount":"","email":"U2FsdGVkX19CyO94mEFiWylxzrTgbAfqcq6/A/FLZCoXvDwHuln2jvaciKKPCOKx","eveningPhone":"U2FsdGVkX19GICCwNv6V2XVM3WGy2PgDChwRv26fwAI=","existingHomeValue":"270000","firstName":"U2FsdGVkX1+di1lcnd+ZYs1iTaypvLZAytXEHEDOtI0=","intendedPropertyUse":"","lastName":"U2FsdGVkX19j3SPAkHVmS30nmhYf6bkvQPS+COt6NSM=","leadSource":"","lastDuplicate":"","loanAmount":"230000","loanPurpose":"Refinance","propertyAddress":"U2FsdGVkX1+T2JEEoKVPPOUCqgstdDlgI6USfn8+CB0=","propertyState":"NC","propertyType":"Single Family Home","propertyZipCode":"27705","purchasePrice":"270000","IsMilitary":"","FICO":"740","ActiveProspect":"true","campaignGroup":"Sebonic 1 | Outbound"},"account":"propair-bank","account_id":10,"referer":"Create"}`

let lead_producer = `{"message": "column agent_idssss does not exist in agent_profiles\\n", "exec_info": "(<class \'psycopg2.ProgrammingError\'>, ProgrammingError(\'column \'agent_idssss\' does not exist in agent_profiles\\\\n\'), <traceback object at 0x7fe374a50dc0>)", "stack": "Traceback (most recent call last):\\n  File /home/luis/Propair/propair-serverless/functions/data_architecture/leads/leads_producer.py, line 64, in getAgentMapping\\n    cur.execute(query)\\npsycopg2.ProgrammingError: column agent_idssss does not exist in agent_profiles\\n\\n", "referer": "Leads_Producer", "name": "Leads_Producer", "error_type": "PythonException", "account": "propair-bank"}`

let direct_mail = `{"stack":"ProcessDirectMail: DirectMail returned no leads\n    at Object.exports.handler (/home/luis/Propair/propair-serverless/functions/leads/direct_mail/api.js:318:47)\n    at process._tickCallback (internal/process/next_tick.js:68:7)","message":"DirectMail returned no leads","name":"ProcessDirectMail","referer":"ProcessDirectMail","event":{"Records":[{"eventVersion":"2.1","eventSource":"aws:s3","awsRegion":"us-west-1","eventTime":"2019-11-15T13:14:08.073Z","eventName":"ObjectCreated:Put","s3":{"s3SchemaVersion":"1.0","configurationId":"DirectMailPut","bucket":{"name":"pro-pair-serverless-staging","ownerIdentity":{"principalId":"A3KB0F0FZHR41M"},"arn":"arn:aws:s3:::pro-pair-serverless-staging"},"object":{"key":"direct_mail/fedsavings/upload/20200122_Propair_Upload.csv","size":6358,"eTag":"ced1f40824a7351eaf21bce839a6e8a8","sequencer":"005DCEA85A39048F09"}}}]},"account":"fedsavings"}`

let leads_consumer = `{"message": "\'list\' object cannot be interpreted as an integer", "exec_info": "(<class \'Exception\'>, Exception(\'\'list\' object cannot be interpreted as an integer\'), <traceback object at 0x7f71bcb81550>)", "stack": "Traceback (most recent call last):\\n  File /home/luis/Propair/propair-kafka/consumers/consumer_executioner.py, line 83, in execute_consumer\\n    raise Exception(\'list\' object cannot be interpreted as an integer)\\nException: \'list\' object cannot be interpreted as an integer\\n", "referer": "LeadsConsumerError", "name": "LeadsConsumerError", "error_type": "PythonException"}`
let scheduler_error = `{"message": "WATTTTT", "exec_info": "(<class \'Exception\'>, Exception(\'WATTTTT\'), <traceback object at 0x7ff4e77ac3c0>)", "stack": "Traceback (most recent call last):\\n  File /home/luis/Propair/propair-serverless/functions/data_architecture/events/scheduler.py, line 36, in update\\n    raise Exception(WATTTTT)\\nException: WATTTTT\\n", "referer": "EventsScheduler", "name": "EventsScheduler", "error_type": "PythonException"}`

let log_consumer = `{"message": "LOG ERROR", "exec_info": "(<class \'Exception\'>, Exception(\'LOG ERROR\'), <traceback object at 0x7f415fca1fa0>)", "stack": "Traceback (most recent call last):\\n  File /home/luis/Propair/propair-kafka/consumers/consumer_executioner.py, line 72, in execute_consumer\\n    raise Exception(LOG ERROR)\\nException: LOG ERROR\\n", "referer": "LogsConsumerError", "name": "LogsConsumerError", "error_type": "PythonException"}`

let no_proper_cardinal_model = `{"map": {"va": 0, "source_description": "Team - 843", "BIN_purpose_detail_stated": "Refi", "hmda_state_id": 53, "source_detail": "R", "credit_score_stated": "", "action_count": "0", "property_use_stated": "", "account_lead_id": "6885630", "competition": 3, "BIN_source": "ALL OTHER", "down_payment": "-$137,000.00", "ialgo": 0, "source_division2": "MISSING", "region_set2": 10, "historical_from201701": null, "bankruptcy_stated": "", "source": "LeadPoint", "cob": 0, "BIN_credit_profile_stated": "Good", "cash_out_stated": "", "region_set1_name": "West", "source_channel": "data", "coldstart": false, "purpose_detail_stated": "Refinance", "BIN_property_type_stated": "SFR", "loan_amount_stated": "$137,000.00", "va_eligible_stated": "Yes", "source_division": "CRL", "transfer": 0, "region_set1": 6, "source_type": "branch", "BIN_property_use_stated": null, "historical_thru201612": null, "mobile": 0, "propair_id": "", "self_generated": 0, "credit_profile_stated": "good", "property_state_stated": "WA", "longform": 0, "property_type_stated": "single family", "home_value_stated": "$250,000.00", "purchase_price_stated": "", "lead_datetime": "8/14/2020 1:44 PM", "region_set2_name": "Northwest", "campaign_group": "Team - 843"}, "source_description": "TEAM - 843", "name": "NoProperCardinalModel", "exec_info": "", "error_type": "PythonException", "source_division": "CRL", "account": "cardinal", "referer": "NoProperCardinalModel", "message": "No Proper Cardinal Model To Use", "campaign_group": "TEAM - 843", "stack": "Traceback (most recent call last):\\n  File \\"/home/luis/Propair/propair-serverless/functions/leads/recommend/recommend.py\\", line 959, in recommend\\n    raise no_proper_model_error\\nProPairError: No Proper Cardinal Model To Use\\n"}`

event = {
    Records: [
        {
            Sns: 
            {
                Message: no_proper_cardinal_model
            }
        }
        
    ]
}
rollbar.handler(event, {}, (a, b) => {
    console.log(a)
    console.log(b)
})